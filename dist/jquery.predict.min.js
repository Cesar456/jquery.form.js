$.fn.predict=function(t){return t=t||{},t.limit=t.limit||10,t.placeholder=t.placeholder||"",t.selected=t.selected||function(){},t.each=t.each||function(){return"<div>"+this+"</div>"},t.filter=t.filter||function(t,e,a){return!!a},t.hintElement=t.hintElement||null,t.dataListElement=t.dataListElement||null,t.toggleItemClass=t.toggleItemClass||"predict-list-item",t.toggleItemClassHover=t.toggleItemClassHover||t.toggleItemClass+"-hover",$(this).each(function(){function e(e){var a=n.find("."+t.toggleItemClass).removeClass(t.toggleItemClassHover);switch(e.keyCode){case 40:s++;break;case 38:s--,0>s&&(s+=a.length+1);break;case 13:return s&&a.eq(s-1).trigger("click"),void 0;default:return!1}return e.preventDefault(),e.stopPropagation(),s%=a.length+1,s>0&&a.eq(s-1).addClass(t.toggleItemClassHover).siblings().removeClass(t.toggleItemClassHover),!0}function a(e){i.add(r).val($(l[e]).text());var a=t.data[e];t.selected.call(a,e,a)}t.hintElement||(t.hintElement=$("<input type='"+this.type+"' style='position:absolute;' class='predict-hint'/>"),$(this).addClass("predict-input").wrap('<span class="predict"></span>').parent().prepend(t.hintElement)),t.dataListElement||(t.dataListElement=$("<div></div>").addClass("predict-list").attr("tabindex","0").insertAfter(this));var i=$(this),n=$(t.dataListElement),r=$(t.hintElement),l=[];r.val(t.placeholder);var s=0;$(t.data).each(function(e){var i=$(t.each.call(this,e,this)).on("mousedown click",function(t){t.preventDefault(),a(e)}).appendTo(n).get(0);l.push(i)}),n.on("keyup",e);var o;$(this).on("keyup click",function(a){if(a.stopPropagation(),e(a))return console.log("Break"),void 0;var i=this.value,n=i.toLowerCase();o=null,s=0,r.val(i?"":t.placeholder);var c=t.limit;$(l).each(function(e){var a=$(this).text(),l=a.toLowerCase(),s=l.match(n)&&t.filter.call(this,e,t.data[e],i);$(this)[s&&--c>0?"addClass":"removeClass"](t.toggleItemClass),s&&i&&a&&0===l.indexOf(n)&&null===o&&(o=e,a=a.replace(RegExp("^"+i,"i"),function(){return i}),r.val(a))})}).on("keydown",function(t){if(t.stopPropagation(),9===t.which||13===t.which)if(s)t.preventDefault(),e(t);else{var n=r.val(),l=i.val();n&&n!==l&&(t.preventDefault(),$(this).val(n),a(o))}})})};